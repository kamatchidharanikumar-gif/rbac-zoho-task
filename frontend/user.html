<!DOCTYPE html>
<html>
<head>
  <title>User Dashboard</title>
  <style>
  body {
    margin: 0;
    min-height: 100vh;
    font-family: Arial, sans-serif;
    background: linear-gradient(-45deg, #8360c3, #2ebf91, #ffb347, #ffcc33);
    background-size: 400% 400%;
    animation: userBG 20s ease infinite;
    padding: 40px;
  }

  @keyframes userBG {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .card {
    background: white;
    margin: auto;
    padding: 30px;
    border-radius: 8px;
    max-width: 800px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.25);
  }
</style>

  <style>
  .logout-btn {
    position: fixed;
    bottom: 10px;
    left: 10px;
    padding: 8px 14px;
    cursor: pointer;
  }
</style>

</head>
<button onclick="logout()" class="logout-btn">Logout</button>


<body>
<div class="card">
  


  <h2>User Dashboard</h2>
<p id="roleInfo"></p>

  <p>
    You are logged in as <b>User</b>.<br>
    Data shown below is based on your role permissions.
  </p>

  <table border="1" id="empTable"></table>

  <script>
    const params = new URLSearchParams(window.location.search);
    const roleId = params.get("role");
    let roleName = "Viewer";
if (roleId == 1) roleName = "Admin";
if (roleId == 2) roleName = "User";

document.getElementById("roleInfo").innerHTML =
  "Your role: <b>" + roleName + "</b>";


    fetch("http://localhost:3000/employees/" + roleId)
      .then(res => res.json())
      .then(data => {
        if (data.length === 0) {
  document.getElementById("empTable").innerHTML =
    "<tr><td><b>Access denied:</b> No permission to view employee data</td></tr>";
  return;
}


        let html = "<tr>";
        Object.keys(data[0]).forEach(key => {
          html += "<th>" + key + "</th>";
        });
        html += "</tr>";

        data.forEach(row => {
          html += "<tr>";
          Object.values(row).forEach(val => {
            html += "<td>" + val + "</td>";
          });
          html += "</tr>";
        });

        document.getElementById("empTable").innerHTML = html;
      });
      function logout() {
  window.location.href = "login.html";
}

  </script>
</div>
</body>
</html>
